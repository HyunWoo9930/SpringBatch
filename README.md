# SpringBatch

* ### Batch
    * 일괄처리
* 사용 예
    * 엄청나게 큰 데이터를 가공해야 하는데 예를 들어 그 작업을 하루에 1번 정도 해줘야 한다.
        * 엄청나게 큰 데이터를 가공해야 한다 ?
            * CPU, I/O 등의 자원 처리에 서버 부하가 발생
            * Request 처리를 올바르게 할 수 없다.
            * 데이터 처리 중에 실패 발생하면, 다시 처음부터 하는게 아니라 끝난 지점부터하는게 좋음 (5만1번째)
        * 하루에 딱 1번 한다 ?
            * 하루에 한번만 돌게 하는 것을 구현하려고 API를 구성하는 것은 낭비일 수 있음
            * 다른 사람이 한번 더 돌리는 실수를 막아야 함
* SpringBatch는
    * '**단발성**으로 대용량의 데이터를 처리하는 어플리케이션' 이다.
        * Spring MVC를 사용함으로써 비즈니스 로직에 최대한 집중할 수 있었던 것 처럼 Spring Batch를 이용하면 배치 어플리케이션을 동작하는 데 필요한 로직에만 집중할 수 있다.
        * 예를 들어, 이미 실행된 경우 재실행을 불가능 하게 한다거나, 실패된 지점에서 부터 다시 동작시키게 할 수 있다거나... 이런 기능들을 SpringBatch가 쉽게 할 수 있도록 도와준다.

    * Batch Application의 조건
        * 대용량 데이터 - 대용량의 데이터를 가져오거나 전달, 계산 등의 처리를 함
        * 자동화 - 사용자 개입을 최소로 줄여 최대한 자동으로 동작될 수 있도록 한다.
        * 견고성 - 잘못된 데이터를 충돌/중단 없이 처리
        * 신뢰성 - 잘못된 부분을 추적할 수 있음 (로깅 / 알림)
        * 성능 - 지정된 시간 내에 처리, 다른 어플리케이션을 방해하지 않는다.

![](../../../../var/folders/w7/b20fft590_7cd_nb8x2htbl40000gn/T/TemporaryItems/NSIRD_screencaptureui_xTQP4x/Screenshot 2023-03-10 at 10.28.24 AM.png)

![](../../../../var/folders/w7/b20fft590_7cd_nb8x2htbl40000gn/T/TemporaryItems/NSIRD_screencaptureui_467Qkn/Screenshot 2023-03-10 at 10.31.48 AM.png)

Job과 Step은 작업의 최소 단위,  Step을 통해 데이터 읽기/가공/결과기록 등의 로직을 묶어서 관리한다.\
Chunk는 한 번의 operation을 통해 다룰 데이터의 집합으로 각 Step은 설정에 정의된 Chunk 단위에 따라 데이터를 읽어 들이고 가공한 후 기록한다.\
Step의 설정에서 Chunk의 크기를 결정하는데 이는 데이터베이스의 한 row일 수도 있고, CSV 파일의 한 줄일 수도 있다.\
Chunk는 트랜잭션 관리 단위이기도 하여 마지막 처리 시점에 TX를 커밋하거나 롤백한다.\
ItemReader<Input 은 작업 대상이 될 데이터를 읽어 들이는 컴포넌트이다.\
ItemProcessor<Input,Output>은 로직에 따라 가공하고, 변경된 데이터를 리턴한다.\
ItemWriter<Output>은 완성된 데이터를 정해진 곳에 저장/색인한다.

